$(document).ready((function(){$.ajaxSetup({headers:{"X-CSRF-TOKEN":$('meta[name="csrf-token"]').attr("content")}});var a=5,e=1,t=0,s=1,i="/product-management/search";function r(a){var e=window.location.origin,t=window.location.href,s=a.from,i=a.to,r=a.total,d=a.from,n="";$.each(a.data,(function(a,s){$("body").on("mouseover",".hoverimg"+s.product_id,(function(a){$(".img"+s.product_id).addClass("showimg"),$(".img"+s.product_id).removeClass("hiddenimg")})),$("body").on("mouseout",".hoverimg"+s.product_id,(function(a){$(".img"+s.product_id).removeClass("showimg"),$(".img"+s.product_id).addClass("hiddenimg")})),1==s.is_sales&&(sales="Đang bán"),0==s.is_sales&&(sales='<p style="color:red">Ngừng bán</p>'),2==s.is_sales&&(sales="Hết hàng"),null==s.product_image&&(s.product_image="default.png"),n=(n=(n=(n=(n=(n=(n=(n=(n=n+'<tr id="url'+s.product_id+'">')+'<td class="stt">'+d+++"</td>")+'<td><p class="relative hoverimg'+s.product_id+'">'+s.product_name+'</p><img src="'+e+"/img/upload/"+s.product_image+'" class="cssimg img'+s.product_id+' hiddenimg"></td>')+"<td>"+s.description+"</td>")+"<td>$"+s.product_price+"</td>")+'<td id="active'+s.id+'" class="active'+s.is_sales+'">'+sales+"</td>")+'<td data-id="'+s.id+'">')+'<a class="updateProduct btn btn-success" id="'+s.product_id+'" href="'+t+"/edit/"+s.product_id+'" title="Chỉnh sửa"><i class="fas fa-edit"></i></a>')+'<a  class="deleteProduct btn btn-danger" id="'+s.product_id+'" data-name="'+s.product_name+'"  title="Xóa"><i class="fas fa-trash-alt"></i></a>',n+="</td>",n+="</tr>"})),$("tbody").html(n),$("#show").html("Hiển thị từ "+s+" đến "+i+" trong tổng số "+r+" sản phẩm")}$.ajax({dataType:"json",url:i,data:{page:a}}).done((function(d){t=d.last_page,e=d.current_page,$("#pagination").twbsPagination({first:"<<",prev:"<",next:">",last:">>",totalPages:t,visiblePages:e,onPageClick:function(e,t){a=t,0!=s&&$.ajax({dataType:"json",url:i,data:{page:a}}).done((function(a){r(a)}))}}),r(d.data),s=1})),$("body").on("click",".deleteProduct",(function(a){a.preventDefault();var e=$(this).attr("id"),t=$(this).attr("data-name");confirm("Bạn có muốn xóa sản phẩm "+t+" không ?")&&$.ajax({url:"product-management/delete/"+e,type:"GET",data:$(this).serialize(),success:function(a){$("#url"+e).remove(),alert("Đã xóa thành công")},error:function(a){console.log(a)}})})),$(".search").click((function(a){a.preventDefault();var e=5,t=0,s=1,i=$("#search_name").val(),r=$("#is_sale").val(),d=$("#search_price_from").val(),n=$("#search_price_to").val();$.ajax({type:"GET",url:"/product-management/search?search_name="+i+"&is_sale="+r+"&search_price_from="+d+"&search_price_to="+n,dataType:"json",data:{search_name:i,is_sale:r,search_price_from:d,search_price_to:n},success:function(a){function i(a){if(0==a)$(".del").html('<h1 style="margin-left:30%">Không có dữ liệu</h1>');else{var e=a.from,t="";$.each(a.data,(function(a,s){1==s.is_sales&&(sales="Đang bán"),0==s.is_sales&&(sales='<p style="color:red">Ngừng bán</p>'),2==s.is_sales&&(sales="Hết hàng"),t=(t=(t=(t=(t=(t=(t=(t=(t=t+'<tr id="url'+s.product_id+'">')+"<td>"+e+++"</td>")+"<td>"+s.product_name+"</td>")+"<td>"+s.description+"</td>")+"<td>"+s.product_price+"</td>")+'<td id="active'+s.id+'" class="active'+s.is_active+'">'+sales+"</td>")+'<td data-id="'+s.id+'">')+'<a class="updateProduct btn btn-success" id="'+s.product_id+'" href="'+origin+"/product-management/edit/"+s.product_id+'" title="Chỉnh sửa"><i class="fas fa-edit"></i></a>')+'<a  class="deleteProduct btn btn-danger" id="'+s.product_id+'" data-name="'+s.product_name+'"  title="Xóa"><i class="fas fa-trash-alt"></i></a>',t+="</td>",t+="</tr>"})),$("tbody").html(t),$("#pagination").hide(),$("#paginationSearch").removeClass("d-none")}}$("#search_name").prop("disabled",!0),$("#is_sale").prop("disabled",!0),$("#search_price_from").prop("disabled",!0),$("#search_price_to").prop("disabled",!0),t=a.last_page,a.current_page,$("#paginationSearch").twbsPagination({first:"<<",prev:"<",next:">",last:">>",totalPages:t,visiblePages:5,onPageClick:function(a,t){e=t,0!=s&&function(){var a=$("#search_name").val(),t=$("#is_sale").val(),s=$("#search_price_from").val(),r=$("#search_price_to").val();$.ajax({dataType:"json",url:"/product-management/search?search_name="+a+"&is_sale="+t+"&search_price_from="+s+"&search_price_to="+r,data:{page:e,search_name:a,is_sale:t,search_price_from:s,search_price_to:r,visiblePages:5}}).done((function(a){i(a)}))}()}}),i(a.data),s=1},error:function(a){console.log(a)}})})),$(".deleteSearch").click((function(a){location.reload()}));var d=window.location.href+"/autocompletename";$(".search_name").typeahead({source:function(a,e){return $.get(d,{search_name:a},(function(a){return e(a)}))}})}));